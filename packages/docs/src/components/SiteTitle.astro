---
import fs from 'node:fs'
import path from 'node:path'
import type { StarlightRouteData } from '@astrojs/starlight/route-data'

const pkgPath = path.join(process.cwd(), 'node_modules/@aster-ui/prefixed/package.json')
const { version } = JSON.parse(fs.readFileSync(pkgPath, 'utf-8'))

const route = Astro.locals.starlightRoute as StarlightRouteData
const locale = route?.locale
const isRoot = !locale
const prefix = isRoot ? '' : `/${locale}`
const label = locale === 'fr' ? 'Composants' : 'Components'
---

<a href={isRoot ? '/' : `/${locale}`} class="site-title sl-flex">
  <img src="/logo.png" alt="" class="logo" />
  <span>AsterUI</span>
  <span class="version">v{version}</span>
</a>
<nav class="nav-links">
  <a href={`${prefix}/components`}>{label}</a>
</nav>

<style>
  .site-title {
    align-items: center;
    gap: var(--sl-nav-gap);
    font-size: var(--sl-text-h4);
    font-weight: 600;
    color: var(--sl-color-text-accent);
    text-decoration: none;
  }

  .logo {
    height: 2rem;
    width: auto;
  }

  .version {
    font-size: 0.75rem;
    font-weight: 500;
    padding: 0.125rem 0.5rem;
    border-radius: 9999px;
    background: var(--sl-color-gray-5);
    color: var(--sl-color-gray-2);
  }

  .nav-links {
    display: flex;
    align-items: center;
    margin-left: 1.5rem;
  }

  .nav-links a {
    color: var(--sl-color-text);
    text-decoration: none;
    font-weight: 500;
    padding: 0.25rem 0.75rem;
    border-radius: 0.375rem;
    transition: background-color 0.15s;
  }

  .nav-links a:hover {
    background: var(--sl-color-gray-6);
  }
</style>
